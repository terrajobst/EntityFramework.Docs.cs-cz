---
title: Použití souboru migrovat. exe – EF6
author: divega
ms.date: 10/23/2016
ms.assetid: 989ea862-e936-4c85-926a-8cfbef5df5b8
ms.openlocfilehash: 34866ddbbf81f090a064af148a612dd354ae9401
ms.sourcegitcommit: 7a709ce4f77134782393aa802df5ab2718714479
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 12/04/2019
ms.locfileid: "74824808"
---
# <a name="using-migrateexe"></a><span data-ttu-id="bdb9f-102">Použití souboru migrovat. exe</span><span class="sxs-lookup"><span data-stu-id="bdb9f-102">Using migrate.exe</span></span>
<span data-ttu-id="bdb9f-103">Migrace Code First lze použít k aktualizaci databáze v rámci sady Visual Studio, ale lze ji provést také pomocí nástroje příkazového řádku migrovat. exe.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-103">Code First Migrations can be used to update a database from inside visual studio, but can also be executed via the command line tool migrate.exe.</span></span> <span data-ttu-id="bdb9f-104">Tato stránka poskytuje rychlý přehled o tom, jak pomocí nástroje Migration. exe provádět migrace v databázi.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-104">This page will give a quick overview on how to use migrate.exe to execute migrations against a database.</span></span>

> [!NOTE]
> <span data-ttu-id="bdb9f-105">V tomto článku se dozvíte, jak používat Migrace Code First v základních scénářích.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-105">This article assumes you know how to use Code First Migrations in basic scenarios.</span></span> <span data-ttu-id="bdb9f-106">Pokud to neuděláte, budete muset před pokračováním přečíst [migrace Code First](~/ef6/modeling/code-first/migrations/index.md) .</span><span class="sxs-lookup"><span data-stu-id="bdb9f-106">If you don’t, then you’ll need to read [Code First Migrations](~/ef6/modeling/code-first/migrations/index.md) before continuing.</span></span>

## <a name="copy-migrateexe"></a><span data-ttu-id="bdb9f-107">Kopírování souboru migrace. exe</span><span class="sxs-lookup"><span data-stu-id="bdb9f-107">Copy migrate.exe</span></span>

<span data-ttu-id="bdb9f-108">Při instalaci Entity Framework pomocí nástroje NuGet migrace. exe se nachází ve složce Tools staženého balíčku.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-108">When you install Entity Framework using NuGet migrate.exe will be inside the tools folder of the downloaded package.</span></span> <span data-ttu-id="bdb9f-109">V &lt;složka projektu&gt;\\balíčky\\EntityFramework.&lt;verze&gt;\\Tools</span><span class="sxs-lookup"><span data-stu-id="bdb9f-109">In &lt;project folder&gt;\\packages\\EntityFramework.&lt;version&gt;\\tools</span></span>

<span data-ttu-id="bdb9f-110">Po dokončení migrace. exe je třeba ho zkopírovat do umístění sestavení, které obsahuje vaše migrace.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-110">Once you have migrate.exe then you need to copy it to the location of the assembly that contains your migrations.</span></span>

<span data-ttu-id="bdb9f-111">Pokud je vaše aplikace cílena na rozhraní .NET 4, a ne 4,5, pak budete muset zkopírovat soubor **Redirect. config** do umístění a přejmenovat ho **. exe. config**. To znamená, že při migraci. exe získá správné přesměrování vazby, aby bylo možné najít Entity Framework sestavení.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-111">If your application targets .NET 4, and not 4.5, then you will need to copy the **Redirect.config** into the location as well and rename it **migrate.exe.config**. This is so that migrate.exe gets the correct binding redirects to be able to locate the Entity Framework assembly.</span></span>

| <span data-ttu-id="bdb9f-112">.NET 4.5</span><span class="sxs-lookup"><span data-stu-id="bdb9f-112">.NET 4.5</span></span>                                      | <span data-ttu-id="bdb9f-113">.NET 4.0</span><span class="sxs-lookup"><span data-stu-id="bdb9f-113">.NET 4.0</span></span>                                      |
|:----------------------------------------------|:----------------------------------------------|
| ![Soubory .NET 4,5](~/ef6/media/net45files.png) | ![Soubory .NET 4,0](~/ef6/media/net40files.png) |

> [!NOTE]
> <span data-ttu-id="bdb9f-116">migrace. exe nepodporuje sestavení x64.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-116">migrate.exe doesn't support x64 assemblies.</span></span>

<span data-ttu-id="bdb9f-117">Po přesunutí souboru Migration. exe do správné složky byste ho měli být schopni použít ke spouštění migrace z databáze.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-117">Once you have moved migrate.exe to the correct folder then you should be able to use it to execute migrations against the database.</span></span> <span data-ttu-id="bdb9f-118">Tento nástroj je navržený tak, aby prováděl migrace.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-118">All the utility is designed to do is execute migrations.</span></span> <span data-ttu-id="bdb9f-119">Nemůže generovat migrace ani vytvořit skript SQL.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-119">It cannot generate migrations or create a SQL script.</span></span>

## <a name="see-options"></a><span data-ttu-id="bdb9f-120">Zobrazit možnosti</span><span class="sxs-lookup"><span data-stu-id="bdb9f-120">See options</span></span>

``` console
Migrate.exe /?
```

<span data-ttu-id="bdb9f-121">Výše uvedený postup zobrazí stránku s nápovědu přidruženou k tomuto nástroji. aby to fungovalo, budete muset mít EntityFramework. dll ve stejném umístění, ve kterém spouštíte příkaz migrovat. exe.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-121">The above will display the help page associated with this utility, note that you will need to have the EntityFramework.dll in the same location that you are running migrate.exe in order for this to work.</span></span>

## <a name="migrate-to-the-latest-migration"></a><span data-ttu-id="bdb9f-122">Migrace na nejnovější migraci</span><span class="sxs-lookup"><span data-stu-id="bdb9f-122">Migrate to the latest migration</span></span>

``` console
Migrate.exe MyMvcApplication.dll /startupConfigurationFile="..\\web.config"
```

<span data-ttu-id="bdb9f-123">Při spuštění souboru Migration. exe jediným povinným parametrem je sestavení, které je sestavením obsahující migrace, které se pokoušíte spustit, ale bude používat všechna nastavení založená na konvencích, pokud neurčíte konfigurační soubor.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-123">When running migrate.exe the only mandatory parameter is the assembly, which is the assembly that contains the migrations that you are trying to run, but it will use all convention based settings if you do not specify the configuration file.</span></span>

## <a name="migrate-to-a-specific-migration"></a><span data-ttu-id="bdb9f-124">Migrace na konkrétní migraci</span><span class="sxs-lookup"><span data-stu-id="bdb9f-124">Migrate to a specific migration</span></span>

``` console
Migrate.exe MyApp.exe /startupConfigurationFile="MyApp.exe.config" /targetMigration="AddTitle"
```

<span data-ttu-id="bdb9f-125">Pokud chcete spustit migrace až do konkrétní migrace, můžete zadat název migrace.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-125">If you want to run migrations up to a specific migration, then you can specify the name of the migration.</span></span> <span data-ttu-id="bdb9f-126">Tato akce spustí všechny předchozí migrace podle potřeby, dokud se nezadá migrace.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-126">This will run all previous migrations as required until getting to the migration specified.</span></span>

## <a name="specify-working-directory"></a><span data-ttu-id="bdb9f-127">Zadat pracovní adresář</span><span class="sxs-lookup"><span data-stu-id="bdb9f-127">Specify working directory</span></span>

``` console
Migrate.exe MyApp.exe /startupConfigurationFile="MyApp.exe.config" /startupDirectory="c:\\MyApp"
```

<span data-ttu-id="bdb9f-128">Pokud sestavení obsahuje závislosti nebo čte soubory vzhledem k pracovnímu adresáři, budete muset nastavit startupDirectory.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-128">If you assembly has dependencies or reads files relative to the working directory then you will need to set startupDirectory.</span></span>

## <a name="specify-migration-configuration-to-use"></a><span data-ttu-id="bdb9f-129">Zadejte konfiguraci migrace, která se má použít.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-129">Specify migration configuration to use</span></span>

``` console
Migrate.exe MyAssembly CustomConfig /startupConfigurationFile="..\\web.config"
```

<span data-ttu-id="bdb9f-130">Pokud máte více tříd konfigurace migrace, třídy, které dědí z DbMigrationConfiguration, je nutné zadat, který má být použit pro toto spuštění.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-130">If you have multiple migration configuration classes, classes inheriting from DbMigrationConfiguration, then you need to specify which is to be used for this execution.</span></span> <span data-ttu-id="bdb9f-131">To je určeno zadáním volitelného druhého parametru bez přepínače, jak je uvedeno výše.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-131">This is specified by providing the optional second parameter without a switch as above.</span></span>

## <a name="provide-connection-string"></a><span data-ttu-id="bdb9f-132">Zadat připojovací řetězec</span><span class="sxs-lookup"><span data-stu-id="bdb9f-132">Provide connection string</span></span>

``` console
Migrate.exe BlogDemo.dll /connectionString="Data Source=localhost;Initial Catalog=BlogDemo;Integrated Security=SSPI" /connectionProviderName="System.Data.SqlClient"
```

<span data-ttu-id="bdb9f-133">Pokud chcete zadat připojovací řetězec z příkazového řádku, musíte zadat také název poskytovatele.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-133">If you wish to specify a connection string at the command line then you must also provide the provider name.</span></span> <span data-ttu-id="bdb9f-134">Pokud neurčíte název poskytovatele, vyvolá se výjimka.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-134">Not specifying the provider name will cause an exception.</span></span>

## <a name="common-problems"></a><span data-ttu-id="bdb9f-135">Běžné problémy</span><span class="sxs-lookup"><span data-stu-id="bdb9f-135">Common Problems</span></span>

| <span data-ttu-id="bdb9f-136">Chybová zpráva</span><span class="sxs-lookup"><span data-stu-id="bdb9f-136">Error Message</span></span>                                                                                                                                                                                                                                                                                                                      | <span data-ttu-id="bdb9f-137">Řešení</span><span class="sxs-lookup"><span data-stu-id="bdb9f-137">Solution</span></span>                                                                                                                                                                                                                                                                                             |
|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <span data-ttu-id="bdb9f-138">Neošetřená výjimka: System. IO. FileLoadException: nelze načíst soubor nebo sestavení EntityFramework, Version = 5.0.0.0, Culture = neutral, PublicKeyToken = b77a5c561934e089 nebo jedna z jejích závislostí.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-138">Unhandled Exception: System.IO.FileLoadException:  Could not load file or assembly 'EntityFramework, Version=5.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies.</span></span> <span data-ttu-id="bdb9f-139">Nalezená definice manifestu sestavení neodpovídá odkazu na sestavení.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-139">The located assembly's manifest definition does not match the assembly reference.</span></span> <span data-ttu-id="bdb9f-140">(Výjimka z HRESULT: 0x80131040)</span><span class="sxs-lookup"><span data-stu-id="bdb9f-140">(Exception from HRESULT: 0x80131040)</span></span>         | <span data-ttu-id="bdb9f-141">To obvykle znamená, že máte spuštěnou aplikaci .NET 4 bez souboru Redirect. config.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-141">This typically means that you are running a .NET 4 application without the Redirect.config file.</span></span> <span data-ttu-id="bdb9f-142">Musíte zkopírovat soubor Redirect. config do stejného umístění jako soubor migrovat. exe a přejmenovat ho na soubor migrovat. exe. config.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-142">You need to copy the Redirect.config to the same location as migrate.exe and rename it to migrate.exe.config.</span></span>                                                                                       |
| <span data-ttu-id="bdb9f-143">Neošetřená výjimka: System. IO. FileLoadException: nelze načíst soubor nebo sestavení EntityFramework, Version = 4.4.0.0, Culture = neutral, PublicKeyToken = b77a5c561934e089 nebo jedna z jejích závislostí.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-143">Unhandled Exception: System.IO.FileLoadException: Could not load file or assembly 'EntityFramework, Version=4.4.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089' or one of its dependencies.</span></span> <span data-ttu-id="bdb9f-144">Nalezená definice manifestu sestavení neodpovídá odkazu na sestavení.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-144">The located assembly's manifest definition does not match the assembly reference.</span></span> <span data-ttu-id="bdb9f-145">(Výjimka z HRESULT: 0x80131040)</span><span class="sxs-lookup"><span data-stu-id="bdb9f-145">(Exception from HRESULT: 0x80131040)</span></span>          | <span data-ttu-id="bdb9f-146">Tato výjimka znamená, že máte spuštěnou aplikaci .NET 4,5 s příponou Redirect. config zkopírovanou do umístění migrace. exe.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-146">This exception means that you are running a .NET 4.5 application with the Redirect.config copied to the migrate.exe location.</span></span> <span data-ttu-id="bdb9f-147">Pokud je vaše aplikace .NET 4,5, nemusíte mít konfigurační soubor s přesměrováním v.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-147">If your app is .NET 4.5 then you do not need to have the config file with the redirects inside.</span></span> <span data-ttu-id="bdb9f-148">Odstraňte soubor migrovat. exe. config.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-148">Delete the migrate.exe.config file.</span></span>                                    |
| <span data-ttu-id="bdb9f-149">Chyba: databázi se nepovedlo aktualizovat tak, aby odpovídala aktuálnímu modelu, protože existují probíhající změny a Automatická migrace je zakázaná.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-149">ERROR: Unable to update database to match the current model because there are pending changes and automatic migration is disabled.</span></span> <span data-ttu-id="bdb9f-150">Napíšete probíhající změny modelu do migrace založené na kódu nebo povolte automatickou migraci.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-150">Either write the pending model changes to a code-based migration or enable automatic migration.</span></span> <span data-ttu-id="bdb9f-151">Chcete-li povolit automatickou migraci, nastavte DbMigrationsConfiguration. AutomaticMigrationsEnabled na hodnotu true.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-151">Set DbMigrationsConfiguration.AutomaticMigrationsEnabled to true to enable automatic migration.</span></span> | <span data-ttu-id="bdb9f-152">K této chybě dochází, pokud jste migraci nevytvořili, když jste nevytvořili migraci, aby se projevily změny provedené v modelu, a databáze neodpovídá modelu.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-152">This error occurs if running migrate when you haven’t created a migration to cope with changes made to the model, and the database does not match the model.</span></span> <span data-ttu-id="bdb9f-153">Když se do třídy modelu přidá vlastnost a pak se spustí soubor Migration. exe bez vytvoření migrace pro upgrade databáze, je to příklad.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-153">Adding a property to a model class then running migrate.exe without creating a migration to upgrade the database is an example of this.</span></span> |
| <span data-ttu-id="bdb9f-154">Chyba: typ není přeložen pro člena ' System. data. entity. migrations. Design. ToolingFacade + UpdateRunner, EntityFramework, Version = 5.0.0.0, Culture = neutral, PublicKeyToken = b77a5c561934e089 '.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-154">ERROR: Type is not resolved for member 'System.Data.Entity.Migrations.Design.ToolingFacade+UpdateRunner,EntityFramework, Version=5.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.</span></span>                                                                                                                                       | <span data-ttu-id="bdb9f-155">Tato chyba může být způsobena zadáním nesprávného spouštěcího adresáře.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-155">This error can be caused by specifying an incorrect startup directory.</span></span> <span data-ttu-id="bdb9f-156">Musí se jednat o umístění souboru migrace. exe.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-156">This must be the location of migrate.exe</span></span>                                                                                                                                                                                      |
| <span data-ttu-id="bdb9f-157">Neošetřená výjimka: System. NullReferenceException: odkaz na objekt není nastaven na instanci objektu.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-157">Unhandled Exception: System.NullReferenceException: Object reference not set to an instance of an object.</span></span> <br/>   <span data-ttu-id="bdb9f-158">v System. data. entity. migrations. Console. program. Main (String [] args)</span><span class="sxs-lookup"><span data-stu-id="bdb9f-158">at System.Data.Entity.Migrations.Console.Program.Main(String[] args)</span></span>                                                                                                                                             | <span data-ttu-id="bdb9f-159">To může být způsobeno tím, že není zadán požadovaný parametr pro nějaký scénář, který používáte.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-159">This can be caused by not specifying a required parameter for a scenario that you are using.</span></span> <span data-ttu-id="bdb9f-160">Například zadání připojovacího řetězce bez zadání názvu poskytovatele.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-160">For example specifying a connection string without specifying the provider name.</span></span>                                                                                                                        |
| <span data-ttu-id="bdb9f-161">Chyba: v sestavení ' ClassLibrary1 ' byl nalezen více než jeden typ konfigurace migrace.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-161">ERROR: More than one migrations configuration type was found in the assembly 'ClassLibrary1'.</span></span> <span data-ttu-id="bdb9f-162">Zadejte název, který se má použít.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-162">Specify the name of the one to use.</span></span>                                                                                                                                                                                                  | <span data-ttu-id="bdb9f-163">V případě chybových stavů je v daném sestavení více než jedna třída konfigurace.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-163">As the error states, there is more than one configuration class in the given assembly.</span></span> <span data-ttu-id="bdb9f-164">K určení, které chcete použít, je nutné použít přepínač/configurationType.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-164">You must use the /configurationType switch to specify which to use.</span></span>                                                                                                                                           |
| <span data-ttu-id="bdb9f-165">Chyba: nelze načíst soubor nebo sestavení&lt;assemblyName&gt;nebo jedna z jeho závislostí.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-165">ERROR: Could not load file or assembly ‘&lt;assemblyName&gt;’ or one of its dependencies.</span></span> <span data-ttu-id="bdb9f-166">Zadaný název sestavení nebo základ kódu byl neplatný.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-166">The given assembly name or codebase was invalid.</span></span> <span data-ttu-id="bdb9f-167">(Výjimka z HRESULT: 0x80131047)</span><span class="sxs-lookup"><span data-stu-id="bdb9f-167">(Exception from HRESULT: 0x80131047)</span></span>                                                                                                                                                    | <span data-ttu-id="bdb9f-168">To může být způsobeno nesprávným zadáním názvu sestavení nebo nemusíte mít</span><span class="sxs-lookup"><span data-stu-id="bdb9f-168">This can be caused by specifying an assembly name incorrectly or not having</span></span>                                                                                                                                                                                                                          |
| <span data-ttu-id="bdb9f-169">Chyba: nelze načíst soubor nebo sestavení&lt;assemblyName&gt;nebo jedna z jeho závislostí.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-169">ERROR: Could not load file or assembly ‘&lt;assemblyName&gt;' or one of its dependencies.</span></span> <span data-ttu-id="bdb9f-170">Byl proveden pokus o načtení programu v nesprávném formátu.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-170">An attempt was made to load a program with an incorrect format.</span></span>                                                                                                                                                                          | <span data-ttu-id="bdb9f-171">K tomu dochází, pokud se pokoušíte spustit příkaz migrovat. exe proti aplikaci x64.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-171">This happens if you are trying to run migrate.exe against an x64 application.</span></span> <span data-ttu-id="bdb9f-172">EF 5,0 a nižší budou fungovat jenom v x86.</span><span class="sxs-lookup"><span data-stu-id="bdb9f-172">EF 5.0 and below will only work on x86.</span></span>                                                                                                                                                                                |
