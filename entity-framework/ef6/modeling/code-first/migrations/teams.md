---
title: Migrace Code First v prostředích Team - EF6
author: divega
ms.date: 10/23/2016
ms.assetid: 4c2d9a95-de6f-4e97-9738-c1f8043eff69
ms.openlocfilehash: 53460b6cdd454099ccf93b4e2133e4ea21278a64
ms.sourcegitcommit: fa863883f1193d2118c2f9cee90808baa5e3e73e
ms.translationtype: MT
ms.contentlocale: cs-CZ
ms.lasthandoff: 12/04/2018
ms.locfileid: "52857465"
---
# <a name="code-first-migrations-in-team-environments"></a><span data-ttu-id="f99f8-102">Migrace Code First v prostředích Team</span><span class="sxs-lookup"><span data-stu-id="f99f8-102">Code First Migrations in Team Environments</span></span>
> [!NOTE]
> <span data-ttu-id="f99f8-103">Tento článek předpokládá, že víte, jak pomocí migrace Code First v základní scénáře.</span><span class="sxs-lookup"><span data-stu-id="f99f8-103">This article assumes you know how to use Code First Migrations in basic scenarios.</span></span> <span data-ttu-id="f99f8-104">Pokud ne, pak budete muset přečíst [migrace Code First](~/ef6/modeling/code-first/migrations/index.md) než budete pokračovat.</span><span class="sxs-lookup"><span data-stu-id="f99f8-104">If you don’t, then you’ll need to read [Code First Migrations](~/ef6/modeling/code-first/migrations/index.md) before continuing.</span></span>

## <a name="grab-a-coffee-you-need-to-read-this-whole-article"></a><span data-ttu-id="f99f8-105">Stáhněte si kávu, budete muset tento celý článek</span><span class="sxs-lookup"><span data-stu-id="f99f8-105">Grab a coffee, you need to read this whole article</span></span>

<span data-ttu-id="f99f8-106">Problémy v prostředích team jsou většinou kolem sloučení migrace po dvou vývojáři vygenerovaly migrace v jejich místní kódové základny.</span><span class="sxs-lookup"><span data-stu-id="f99f8-106">The issues in team environments are mostly around merging migrations when two developers have generated migrations in their local code base.</span></span> <span data-ttu-id="f99f8-107">Kroky k vyřešení těchto jsou poměrně jednoduché, vyžadují mít důkladného porozumění fungování migrace.</span><span class="sxs-lookup"><span data-stu-id="f99f8-107">While the steps to solve these are pretty simple, they require you to have a solid understanding of how migrations works.</span></span> <span data-ttu-id="f99f8-108">Prosím není právě přeskočte dopředu na konec – čas si přečíst celý článek k zajištění, že máte úspěšné.</span><span class="sxs-lookup"><span data-stu-id="f99f8-108">Please don’t just skip ahead to the end – take the time to read the whole article to ensure you are successful.</span></span>

## <a name="some-general-guidelines"></a><span data-ttu-id="f99f8-109">Některé obecné pokyny</span><span class="sxs-lookup"><span data-stu-id="f99f8-109">Some general guidelines</span></span>

<span data-ttu-id="f99f8-110">Předtím, než se podíváme se podrobně na tom, jak spravovat sloučení migrace generovaných více vývojářů, tady jsou některé obecné pokyny k nastavení vám dá zajistit úspěšnost.</span><span class="sxs-lookup"><span data-stu-id="f99f8-110">Before we dig into how to manage merging migrations generated by multiple developers, here are some general guidelines to set you up for success.</span></span>

### <a name="each-team-member-should-have-a-local-development-database"></a><span data-ttu-id="f99f8-111">Každý člen týmu by měl mít místní vývoj databáze</span><span class="sxs-lookup"><span data-stu-id="f99f8-111">Each team member should have a local development database</span></span>

<span data-ttu-id="f99f8-112">Použití migrace  **\_ \_MigrationsHistory** tabulku pro ukládání, jaké migrace se použily k databázi.</span><span class="sxs-lookup"><span data-stu-id="f99f8-112">Migrations uses the **\_\_MigrationsHistory** table to store what migrations have been applied to the database.</span></span> <span data-ttu-id="f99f8-113">Pokud máte více vývojářů, generuje se při pokusu o cílit na stejné databáze různé migrace (a tedy sdílet  **\_ \_MigrationsHistory** tabulky) migrace bude velmi zmatení.</span><span class="sxs-lookup"><span data-stu-id="f99f8-113">If you have multiple developers generating different migrations while trying to target the same database (and thus share a **\_\_MigrationsHistory** table) migrations is going to get very confused.</span></span>

<span data-ttu-id="f99f8-114">Samozřejmě pokud jste členy týmu, které nejsou generování migrace, neexistuje žádný problém s nimi sdílet centrální vývoje databáze.</span><span class="sxs-lookup"><span data-stu-id="f99f8-114">Of course, if you have team members that aren’t generating migrations, there is no problem having them share a central development database.</span></span>

### <a name="avoid-automatic-migrations"></a><span data-ttu-id="f99f8-115">Vyhněte se automatické migrace</span><span class="sxs-lookup"><span data-stu-id="f99f8-115">Avoid automatic migrations</span></span>

<span data-ttu-id="f99f8-116">Dolní řádek je, že automatické migrace zpočátku vypadat dobře v prostředích team, ale ve skutečnosti právě nefungují.</span><span class="sxs-lookup"><span data-stu-id="f99f8-116">The bottom line is that automatic migrations initially look good in team environments, but in reality they just don’t work.</span></span> <span data-ttu-id="f99f8-117">Pokud budete chtít vědět proč, pokračujte ve čtení – Pokud ne, pak můžete přeskočit k další části.</span><span class="sxs-lookup"><span data-stu-id="f99f8-117">If you want to know why, keep reading – if not, then you can skip to the next section.</span></span>

<span data-ttu-id="f99f8-118">Automatické migrace umožňuje mít schéma databáze aktualizovat tak, aby odpovídaly aktuálním modelu bez nutnosti Generovat soubory kódu (migrace založené na kódu).</span><span class="sxs-lookup"><span data-stu-id="f99f8-118">Automatic migrations allows you to have your database schema updated to match the current model without the need to generate code files (code-based migrations).</span></span> <span data-ttu-id="f99f8-119">Automatické migrace by velmi dobře fungovat v prostředí team, pokud je pouze nikdy nepoužil a nikdy generována všechny migrace na kód.</span><span class="sxs-lookup"><span data-stu-id="f99f8-119">Automatic migrations would work very well in a team environment if you only ever used them and never generated any code-based migrations.</span></span> <span data-ttu-id="f99f8-120">Problém je, že automatické migrace jsou omezené a nezpracovávají počet operací – přejmenuje sloupce nebo vlastností, přesun dat do jiné tabulky, atd. Pro zpracování scénářů skončíte generování migrace na kódu (a úpravy automaticky generovaný kód), které jsou ve smíšeném mezi změny, které jsou zpracovávány automatické migrace.</span><span class="sxs-lookup"><span data-stu-id="f99f8-120">The problem is that automatic migrations are limited and don’t handle a number of operations – property/column renames, moving data to another table, etc. To handle these scenarios you end up generating code-based migrations (and editing the scaffolded code) that are mixed in between changes that are handled by automatic migrations.</span></span> <span data-ttu-id="f99f8-121">Díky tomu téměř na možné sloučit změny, když dva vývojáři vrátit se změnami migrace.</span><span class="sxs-lookup"><span data-stu-id="f99f8-121">This makes it near on impossible to merge changes when two developers check in migrations.</span></span>

## <a name="screencasts"></a><span data-ttu-id="f99f8-122">Screencasty</span><span class="sxs-lookup"><span data-stu-id="f99f8-122">Screencasts</span></span>

<span data-ttu-id="f99f8-123">Pokud byste raději přehrát záznam dění na monitoru než v tomto článku, následující dvě videa zahrnují obsah jako v tomto článku.</span><span class="sxs-lookup"><span data-stu-id="f99f8-123">If you'd rather watch a screencast than read this article, the following two videos cover the same content as this article.</span></span>

### <a name="video-one-migrations---under-the-hood"></a><span data-ttu-id="f99f8-124">Video jeden: "Migrace - pod pokličkou"</span><span class="sxs-lookup"><span data-stu-id="f99f8-124">Video One: "Migrations - Under the Hood"</span></span>

<span data-ttu-id="f99f8-125">[Tento záznam dění na monitoru](http://channel9.msdn.com/blogs/ef/migrations-under-the-hood) vysvětluje, jak migrace sleduje a používá informace o modelu ke zjištění změny modelu.</span><span class="sxs-lookup"><span data-stu-id="f99f8-125">[This screencast](http://channel9.msdn.com/blogs/ef/migrations-under-the-hood) covers how migrations tracks and uses information about the model to detect model changes.</span></span>

### <a name="video-two-migrations---team-environments"></a><span data-ttu-id="f99f8-126">Dvě videa: "Migrace - Týmová prostředí"</span><span class="sxs-lookup"><span data-stu-id="f99f8-126">Video Two: "Migrations - Team Environments"</span></span>

<span data-ttu-id="f99f8-127">Stavíme na koncepty z předchozí video [tento záznam dění na monitoru](http://channel9.msdn.com/blogs/ef/migrations-team-environments) popisuje problémy, které vznikají v týmu prostředí a jak je vyřešit.</span><span class="sxs-lookup"><span data-stu-id="f99f8-127">Building on the concepts from the previous video, [this screencast](http://channel9.msdn.com/blogs/ef/migrations-team-environments) covers the issues that arise in a team environment and how to solve them.</span></span>

## <a name="understanding-how-migrations-works"></a><span data-ttu-id="f99f8-128">Pochopení, jak funguje migrace</span><span class="sxs-lookup"><span data-stu-id="f99f8-128">Understanding how migrations works</span></span>

<span data-ttu-id="f99f8-129">Klíčem k úspěšné použití migrace v prostředí team je základní princip, jak migrace sleduje a informace o modelu využívá ke zjištění změny modelu.</span><span class="sxs-lookup"><span data-stu-id="f99f8-129">The key to successfully using migrations in a team environment is a basic understanding how migrations tracks and uses information about the model to detect model changes.</span></span>

### <a name="the-first-migration"></a><span data-ttu-id="f99f8-130">Při první migraci</span><span class="sxs-lookup"><span data-stu-id="f99f8-130">The first migration</span></span>

<span data-ttu-id="f99f8-131">Při první migraci přidáte do projektu, spustíte něco jako **migrace přidat první** v konzole Správce balíčků.</span><span class="sxs-lookup"><span data-stu-id="f99f8-131">When you add the first migration to your project, you run something like **Add-Migration First** in Package Manager Console.</span></span> <span data-ttu-id="f99f8-132">Kroky na nejvyšší úrovni, které provádí tento příkaz jsou na obrázku níže.</span><span class="sxs-lookup"><span data-stu-id="f99f8-132">The high level steps that this command performs are pictured below.</span></span>

![První migrace](~/ef6/media/firstmigration.png)

<span data-ttu-id="f99f8-134">Aktuální model se počítá z uživatelského kódu (1).</span><span class="sxs-lookup"><span data-stu-id="f99f8-134">The current model is calculated from your code (1).</span></span> <span data-ttu-id="f99f8-135">Požadované databázové objekty jsou pak vypočítá podle modelu se liší (2) – protože se jedná o první migraci modelu se liší jenom používá prázdný model pro porovnání.</span><span class="sxs-lookup"><span data-stu-id="f99f8-135">The required database objects are then calculated by the model differ (2) – since this is the first migration the model differ just uses an empty model for the comparison.</span></span> <span data-ttu-id="f99f8-136">Požadované změny se předají generátor kódu sestavení kódu vyžaduje migraci (3), která se pak přidá do řešení sady Visual Studio (4).</span><span class="sxs-lookup"><span data-stu-id="f99f8-136">The required changes are passed to the code generator to build the required migration code (3) which is then added to your Visual Studio solution (4).</span></span>

<span data-ttu-id="f99f8-137">Kromě skutečné migrace kódu, který je uložen v souboru hlavní kód generuje migrace také některé další použití modelu code-behind soubory.</span><span class="sxs-lookup"><span data-stu-id="f99f8-137">In addition to the actual migration code that is stored in the main code file, migrations also generates some additional code-behind files.</span></span> <span data-ttu-id="f99f8-138">Tyto soubory jsou metadata, která používá migrace a nejsou něco, co byste měli upravovat.</span><span class="sxs-lookup"><span data-stu-id="f99f8-138">These files are metadata that is used by migrations and are not something you should edit.</span></span> <span data-ttu-id="f99f8-139">Některý z těchto souborů je soubor prostředku (RESX), který obsahuje snímek modelu v době, kdy byla vygenerována migrace.</span><span class="sxs-lookup"><span data-stu-id="f99f8-139">One of these files is a resource file (.resx) that contains a snapshot of the model at the time the migration was generated.</span></span> <span data-ttu-id="f99f8-140">Uvidíte jak, to se používá v dalším kroku.</span><span class="sxs-lookup"><span data-stu-id="f99f8-140">You’ll see how this is used in the next step.</span></span>

<span data-ttu-id="f99f8-141">V tomto okamžiku by pravděpodobně spuštění **aktualizace databáze** použít změny v databázi, a pak přejděte o implementaci jiných oblastech vaší aplikace.</span><span class="sxs-lookup"><span data-stu-id="f99f8-141">At this point you would probably run **Update-Database** to apply your changes to the database, and then go about implementing other areas of your application.</span></span>

### <a name="subsequent-migrations"></a><span data-ttu-id="f99f8-142">Následné migrace</span><span class="sxs-lookup"><span data-stu-id="f99f8-142">Subsequent migrations</span></span>

<span data-ttu-id="f99f8-143">Později vrátit a provést nějaké změny do modelu – v našem příkladu přidáme **Url** vlastnost **blogu**.</span><span class="sxs-lookup"><span data-stu-id="f99f8-143">Later you come back and make some changes to your model – in our example we’ll add a **Url** property to **Blog**.</span></span> <span data-ttu-id="f99f8-144">By potom vydat příkaz například **přidat migrace AddUrl** scaffold migrace použít odpovídající databáze změní.</span><span class="sxs-lookup"><span data-stu-id="f99f8-144">You would then issue a command such as **Add-Migration AddUrl** to scaffold a migration to apply the corresponding database changes.</span></span> <span data-ttu-id="f99f8-145">Kroky na nejvyšší úrovni, které provádí tento příkaz jsou na obrázku níže.</span><span class="sxs-lookup"><span data-stu-id="f99f8-145">The high level steps that this command performs are pictured below.</span></span>

![Druhý migrace](~/ef6/media/secondmigration.png)

<span data-ttu-id="f99f8-147">Stejně jako předtím se vypočítá aktuální model z kódu (1).</span><span class="sxs-lookup"><span data-stu-id="f99f8-147">Just like last time, the current model is calculated from code (1).</span></span> <span data-ttu-id="f99f8-148">Nyní existují však existující migrace tak předchozí model se načte z nejnovější migrace (2).</span><span class="sxs-lookup"><span data-stu-id="f99f8-148">However, this time there are existing migrations so the previous model is retrieved from the latest migration (2).</span></span> <span data-ttu-id="f99f8-149">Tyto dva modely jsou diffed vyhledat změny databáze (3) a potom dokončí proces stejně jako předtím.</span><span class="sxs-lookup"><span data-stu-id="f99f8-149">These two models are diffed to find the required database changes (3) and then the process completes as before.</span></span>

<span data-ttu-id="f99f8-150">Tento stejný postup se používá pro všechny další migrace, které přidáte do projektu.</span><span class="sxs-lookup"><span data-stu-id="f99f8-150">This same process is used for any further migrations that you add to the project.</span></span>

### <a name="why-bother-with-the-model-snapshot"></a><span data-ttu-id="f99f8-151">Proč zabývat snímku modelu?</span><span class="sxs-lookup"><span data-stu-id="f99f8-151">Why bother with the model snapshot?</span></span>

<span data-ttu-id="f99f8-152">Asi vás zajímá proč EF bothers klauzuli with snapshot modelu – Proč ne jenom pohled na databázi.</span><span class="sxs-lookup"><span data-stu-id="f99f8-152">You may be wondering why EF bothers with the model snapshot – why not just look at the database.</span></span> <span data-ttu-id="f99f8-153">Pokud ano, přečtěte si o.</span><span class="sxs-lookup"><span data-stu-id="f99f8-153">If so, read on.</span></span> <span data-ttu-id="f99f8-154">Pokud si nejste chtěli můžete tuto část přeskočit.</span><span class="sxs-lookup"><span data-stu-id="f99f8-154">If you’re not interested then you can skip this section.</span></span>

<span data-ttu-id="f99f8-155">Existuje mnoho důvodů, které EF udržuje snímku modelu kolem:</span><span class="sxs-lookup"><span data-stu-id="f99f8-155">There are a number of reasons EF keeps the model snapshot around:</span></span>

-   <span data-ttu-id="f99f8-156">To umožňuje databáze z modelu EF odchylek.</span><span class="sxs-lookup"><span data-stu-id="f99f8-156">It allows your database to drift from the EF model.</span></span> <span data-ttu-id="f99f8-157">Tyto změny provést přímo v databázi, nebo můžete změnit automaticky generovaný kód ve vaší migrace, aby se změny.</span><span class="sxs-lookup"><span data-stu-id="f99f8-157">These changes can be made directly in the database, or you can change the scaffolded code in your migrations to make the changes.</span></span> <span data-ttu-id="f99f8-158">Tady je několik příkladů to v praxi:</span><span class="sxs-lookup"><span data-stu-id="f99f8-158">Here are a couple of examples of this in practice:</span></span>
    -   <span data-ttu-id="f99f8-159">Chcete přidat Inserted a aktualizované sloupce na jeden nebo více tabulek, ale nechcete zahrnout tyto sloupce do modelu EF.</span><span class="sxs-lookup"><span data-stu-id="f99f8-159">You want to add an Inserted and Updated to column to one or more of your tables but you don’t want to include these columns in the EF model.</span></span> <span data-ttu-id="f99f8-160">Pokud migrace podívali se na databázi průběžně, pokusí se odebrat tyto sloupce pokaždé, když se automaticky migrace.</span><span class="sxs-lookup"><span data-stu-id="f99f8-160">If migrations looked at the database it would continually try to drop these columns every time you scaffolded a migration.</span></span> <span data-ttu-id="f99f8-161">Pomocí modelu snímku, EF vždy jen rozpozná legitimní změny modelu.</span><span class="sxs-lookup"><span data-stu-id="f99f8-161">Using the model snapshot, EF will only ever detect legitimate changes to the model.</span></span>
    -   <span data-ttu-id="f99f8-162">Chcete změnit text uložené procedury používané pro aktualizace zahrnout určité protokolování.</span><span class="sxs-lookup"><span data-stu-id="f99f8-162">You want to change the body of a stored procedure used for updates to include some logging.</span></span> <span data-ttu-id="f99f8-163">Pokud migrace podívali se na tuto uloženou proceduru z databáze ji by průběžně zkuste a obnovit jej do definice, která očekává EF.</span><span class="sxs-lookup"><span data-stu-id="f99f8-163">If migrations looked at this stored procedure from the database it would continually try and reset it back to the definition that EF expects.</span></span> <span data-ttu-id="f99f8-164">Pomocí snímku modelu EF bude vždy jen generování uživatelského rozhraní kódu pro úpravu uložené procedury při změně tvaru podle postupu v modelu EF.</span><span class="sxs-lookup"><span data-stu-id="f99f8-164">By using the model snapshot, EF will only ever scaffold code to alter the stored procedure when you change the shape of the procedure in the EF model.</span></span>
    -   <span data-ttu-id="f99f8-165">Tyto stejné zásady platí i pro přidání dalších indexů, včetně další tabulky v databázi, mapování EF na zobrazení databáze, který je umístěný v tabulce, atd.</span><span class="sxs-lookup"><span data-stu-id="f99f8-165">These same principles apply to adding extra indexes, including extra tables in your database, mapping EF to a database view that sits over a table, etc.</span></span>
-   <span data-ttu-id="f99f8-166">EF model obsahuje více než jen tvar databáze.</span><span class="sxs-lookup"><span data-stu-id="f99f8-166">The EF model contains more than just the shape of the database.</span></span> <span data-ttu-id="f99f8-167">Celý model umožňuje migrace podívat se na informace o vlastnostech a třídy v modelu a jak jsou mapovány pro tabulky a sloupce.</span><span class="sxs-lookup"><span data-stu-id="f99f8-167">Having the entire model allows migrations to look at information about the properties and classes in your model and how they map to the columns and tables.</span></span> <span data-ttu-id="f99f8-168">Tyto informace umožňují migrace bude inteligentnější v kódu, který se vygeneruje uživatelské rozhraní.</span><span class="sxs-lookup"><span data-stu-id="f99f8-168">This information allows migrations to be more intelligent in the code that it scaffolds.</span></span> <span data-ttu-id="f99f8-169">Například pokud změníte název sloupce, který se mapuje vlastnost migrace dokáže přejmenování tak zjistíte, že je stejná vlastnost – něco, co nelze provést, pokud máte pouze schéma databáze.</span><span class="sxs-lookup"><span data-stu-id="f99f8-169">For example, if you change the name of the column that a property maps to migrations can detect the rename by seeing that it’s the same property – something that can’t be done if you only have the database schema.</span></span> 

## <a name="what-causes-issues-in-team-environments"></a><span data-ttu-id="f99f8-170">Co způsobuje problémy v prostředích team</span><span class="sxs-lookup"><span data-stu-id="f99f8-170">What causes issues in team environments</span></span>

<span data-ttu-id="f99f8-171">Pracovní postup popsané v předchozí části funguje skvělé po jeden vývojář, pracující na aplikaci.</span><span class="sxs-lookup"><span data-stu-id="f99f8-171">The workflow covered in the previous section works great when you are a single developer working on an application.</span></span> <span data-ttu-id="f99f8-172">Je také dobře funguje v prostředí team Pokud jste jediná osoba změn do modelu.</span><span class="sxs-lookup"><span data-stu-id="f99f8-172">It also works well in a team environment if you are the only person making changes to the model.</span></span> <span data-ttu-id="f99f8-173">V tomto scénáři můžete měnit model, generovat migrace a odesílat je na vaší správy zdrojového kódu.</span><span class="sxs-lookup"><span data-stu-id="f99f8-173">In this scenario you can make model changes, generate migrations and submit them to your source control.</span></span> <span data-ttu-id="f99f8-174">Ostatní vývojáři mohou synchronizace změn a spustit **aktualizace databáze** změny schématu použít.</span><span class="sxs-lookup"><span data-stu-id="f99f8-174">Other developers can sync your changes and run **Update-Database** to have the schema changes applied.</span></span>

<span data-ttu-id="f99f8-175">Položky problémů umožňují zahájit vzniknou, když máte více vývojářů provádění změn modelu EF a odešlete do správy zdrojového kódu ve stejnou dobu.</span><span class="sxs-lookup"><span data-stu-id="f99f8-175">Issues start to arise when you have multiple developers making changes to the EF model and submitting to source control at the same time.</span></span> <span data-ttu-id="f99f8-176">Co chybí EF je prvotřídní způsob, jak sloučit vaše místní migrace s migrace, které pro jiné vývojáře má odeslat do správy zdrojových kódů, protože poslední synchronizace.</span><span class="sxs-lookup"><span data-stu-id="f99f8-176">What EF lacks is a first class way to merge your local migrations with migrations that another developer has submitted to source control since you last synced.</span></span>

## <a name="an-example-of-a-merge-conflict"></a><span data-ttu-id="f99f8-177">Příkladem konfliktu při slučování</span><span class="sxs-lookup"><span data-stu-id="f99f8-177">An example of a merge conflict</span></span>

<span data-ttu-id="f99f8-178">První Podívejme se na konkrétní příkladem konfliktu sloučení.</span><span class="sxs-lookup"><span data-stu-id="f99f8-178">First let’s look at a concrete example of such a merge conflict.</span></span> <span data-ttu-id="f99f8-179">Na budeme pokračovat s příkladu, který jsme se podívali na dříve.</span><span class="sxs-lookup"><span data-stu-id="f99f8-179">We’ll continue on with the example we looked at earlier.</span></span> <span data-ttu-id="f99f8-180">Jako počáteční bod Pojďme předpokládají původní vývojáře byly vráceny změny z předchozí části.</span><span class="sxs-lookup"><span data-stu-id="f99f8-180">As a starting point let’s assume the changes from the previous section were checked in by the original developer.</span></span> <span data-ttu-id="f99f8-181">Budete sledujeme dva vývojářům jejich provádění změn kódu základní.</span><span class="sxs-lookup"><span data-stu-id="f99f8-181">We’ll track two developers as they make changes to code base.</span></span>

<span data-ttu-id="f99f8-182">Sledujeme budete modelu EF a migrace do řadu změn.</span><span class="sxs-lookup"><span data-stu-id="f99f8-182">We’ll track the EF model and the migrations thru a number of changes.</span></span> <span data-ttu-id="f99f8-183">Pro výchozí bod jak vývojáři synchronizaci do úložiště správy zdrojového kódu, jak je znázorněno na následujícím obrázku.</span><span class="sxs-lookup"><span data-stu-id="f99f8-183">For a starting point, both developers have synced to the source control repository, as depicted in the following graphic.</span></span>

![Počáteční bod](~/ef6/media/startingpoint.png)

<span data-ttu-id="f99f8-185">Pro vývojáře \#1 a pro vývojáře \#2 teď provádí některé změny v modelu EF v jejich místní kódu základní.</span><span class="sxs-lookup"><span data-stu-id="f99f8-185">Developer \#1 and developer \#2 now makes some changes to the EF model in their local code base.</span></span> <span data-ttu-id="f99f8-186">Pro vývojáře \#1 přidá **hodnocení** vlastnost **blogu** – a generuje **AddRating** migrace změny se projeví do databáze.</span><span class="sxs-lookup"><span data-stu-id="f99f8-186">Developer \#1 adds a **Rating** property to **Blog** – and generates an **AddRating** migration to apply the changes to the database.</span></span> <span data-ttu-id="f99f8-187">Pro vývojáře \#2 přidá **čtenáři** vlastnost **blogu** – a vygeneruje odpovídající **AddReaders** migrace.</span><span class="sxs-lookup"><span data-stu-id="f99f8-187">Developer \#2 adds a **Readers** property to **Blog** – and generates the corresponding **AddReaders** migration.</span></span> <span data-ttu-id="f99f8-188">Spustit i vývojáře **aktualizace databáze**, abyste mohli aplikovat změny na svých místních databází a potom pokračovat ve vývoji aplikace.</span><span class="sxs-lookup"><span data-stu-id="f99f8-188">Both developers run **Update-Database**, to apply the changes to their local databases, and then continue developing the application.</span></span>

> [!NOTE]
> <span data-ttu-id="f99f8-189">Migrace mají předponu časové razítko, aby naše obrázek, který představuje AddReaders migrace z Developer \#2, po migraci AddRating pochází Developer \#1.</span><span class="sxs-lookup"><span data-stu-id="f99f8-189">Migrations are prefixed with a timestamp, so our graphic represents that the AddReaders migration from Developer \#2 comes after the AddRating migration from Developer \#1.</span></span> <span data-ttu-id="f99f8-190">Ať už pro vývojáře \#1 nebo \#2 vygenerovat první provede migraci žádný rozdíl na problémy, o práci v týmu nebo procesu pro sloučení jim, najdete v další části.</span><span class="sxs-lookup"><span data-stu-id="f99f8-190">Whether developer \#1 or \#2 generated the migration first makes no difference to the issues of working in a team, or the process for merging them that we’ll look at in the next section.</span></span>

![Místní změny](~/ef6/media/localchanges.png)

<span data-ttu-id="f99f8-192">Je štěstí den pro vývojáře \#1 při jejich provádění předkládat své změny.</span><span class="sxs-lookup"><span data-stu-id="f99f8-192">It’s a lucky day for Developer \#1 as they happen to submit their changes first.</span></span> <span data-ttu-id="f99f8-193">Protože nikdo jiný se přihlásila vzhledem k tomu, že se synchronizují své úložiště, jsou pouze odesílat své změny bez provedení jakékoli sloučení.</span><span class="sxs-lookup"><span data-stu-id="f99f8-193">Because no one else has checked in since they synced their repository, they can just submit their changes without performing any merging.</span></span>

![Odeslat](~/ef6/media/submit.png)

<span data-ttu-id="f99f8-195">Nyní je čas pro vývojáře \#2 k odeslání.</span><span class="sxs-lookup"><span data-stu-id="f99f8-195">Now it’s time for Developer \#2 to submit.</span></span> <span data-ttu-id="f99f8-196">Nejsou tedy měli.</span><span class="sxs-lookup"><span data-stu-id="f99f8-196">They aren’t so lucky.</span></span> <span data-ttu-id="f99f8-197">Protože změny někoho jiného má odeslat, protože jsou synchronizované, se musí stáhnout změny a sloučení.</span><span class="sxs-lookup"><span data-stu-id="f99f8-197">Because someone else has submitted changes since they synced, they will need to pull down the changes and merge.</span></span> <span data-ttu-id="f99f8-198">Systém správy zdrojového kódu pravděpodobně bude moci automaticky sloučit změny na úrovni kódu, protože jsou velmi jednoduché.</span><span class="sxs-lookup"><span data-stu-id="f99f8-198">The source control system will likely be able to automatically merge the changes at the code level since they are very simple.</span></span> <span data-ttu-id="f99f8-199">Stav pro vývojáře \#2 na místní úložiště po synchronizaci je znázorněn na následujícím obrázku.</span><span class="sxs-lookup"><span data-stu-id="f99f8-199">The state of Developer \#2’s local repository after syncing is depicted in the following graphic.</span></span> 

![O přijetí změn](~/ef6/media/pull.png)

<span data-ttu-id="f99f8-201">V této fáze pro vývojáře \#2 můžete spustit **aktualizace databáze** který rozpozná nový **AddRating** migrace (která nebyla použita pro vývojáře \#2 databáze) a použijte ji.</span><span class="sxs-lookup"><span data-stu-id="f99f8-201">At this stage Developer \#2 can run **Update-Database** which will detect the new **AddRating** migration (which hasn’t been applied to Developer \#2’s database) and apply it.</span></span> <span data-ttu-id="f99f8-202">Nyní **hodnocení** sloupec se přidá do **blogy** tabulky a databáze je synchronizovaný s modelem.</span><span class="sxs-lookup"><span data-stu-id="f99f8-202">Now the **Rating** column is added to the **Blogs** table and the database is in sync with the model.</span></span>

<span data-ttu-id="f99f8-203">Existuje však několik problémů:</span><span class="sxs-lookup"><span data-stu-id="f99f8-203">There are a couple of problems though:</span></span>

1.  <span data-ttu-id="f99f8-204">I když **aktualizace databáze** budou platit **AddRating** migrace také vyvolá upozornění: *nejde aktualizovat databázi tak, aby odpovídaly aktuálním modelu, protože existují čekající změny a je zakázáno automatické migrace...*</span><span class="sxs-lookup"><span data-stu-id="f99f8-204">Although **Update-Database** will apply the **AddRating** migration it will also raise a warning: *Unable to update database to match the current model because there are pending changes and automatic migration is disabled…*</span></span>
    <span data-ttu-id="f99f8-205">Problém je, že model snímku uloženy poslední migrace (**AddReader**) chybí **hodnocení** vlastnost **blogu** (protože není součástí modelu při Migrace byla vygenerována).</span><span class="sxs-lookup"><span data-stu-id="f99f8-205">The problem is that the model snapshot stored in the last migration (**AddReader**) is missing the **Rating** property on **Blog** (since it wasn’t part of the model when the migration was generated).</span></span> <span data-ttu-id="f99f8-206">Kód nejprve zjistí, že model v posledních migrace neodpovídá aktuální model a vyvolá upozornění.</span><span class="sxs-lookup"><span data-stu-id="f99f8-206">Code First detects that the model in the last migration doesn’t match the current model and raises the warning.</span></span>
2.  <span data-ttu-id="f99f8-207">Spuštění aplikace by mělo za následek InvalidOperationException oznamující, že "*model zálohování kontextu 'BloggingContext' byl změněn, protože byla vytvořena databáze. Vezměte v úvahu pomocí migrace Code First, a aktualizovat databázi..."*</span><span class="sxs-lookup"><span data-stu-id="f99f8-207">Running the application would result in an InvalidOperationException stating that “*The model backing the 'BloggingContext' context has changed since the database was created. Consider using Code First Migrations to update the database…”*</span></span>
    <span data-ttu-id="f99f8-208">Problém je opět modelu snímku uloženy poslední migrace neodpovídá modelu.</span><span class="sxs-lookup"><span data-stu-id="f99f8-208">Again, the problem is the model snapshot stored in the last migration doesn’t match the current model.</span></span>
3.  <span data-ttu-id="f99f8-209">Nakonec by Očekáváme, že spuštění **přidat migrace** nyní vygeneruje prázdný migrace (protože nejsou žádné změny, které chcete použít pro databázi).</span><span class="sxs-lookup"><span data-stu-id="f99f8-209">Finally, we would expect running **Add-Migration** now would generate an empty migration (since there are no changes to apply to the database).</span></span> <span data-ttu-id="f99f8-210">Ale vzhledem k tomu, že migrace porovná aktuální model k jednomu z poslední migrace (které chybí **hodnocení** vlastnost) ji bude ve skutečnosti generování uživatelského rozhraní jiného **AddColumn** volání doplňku **Hodnocení** sloupce.</span><span class="sxs-lookup"><span data-stu-id="f99f8-210">But because migrations compares the current model to the one from the last migration (which is missing the **Rating** property) it will actually scaffold another **AddColumn** call to add in the **Rating** column.</span></span> <span data-ttu-id="f99f8-211">Samozřejmě, tato migrace selže během **aktualizace databáze** protože **hodnocení** sloupec už existuje.</span><span class="sxs-lookup"><span data-stu-id="f99f8-211">Of course, this migration would fail during **Update-Database** because the **Rating** column already exists.</span></span>

## <a name="resolving-the-merge-conflict"></a><span data-ttu-id="f99f8-212">Řešení konfliktu sloučení</span><span class="sxs-lookup"><span data-stu-id="f99f8-212">Resolving the merge conflict</span></span>

<span data-ttu-id="f99f8-213">Dobrou zprávou je, že není příliš obtížné řešit sloučení ručně – Pokud máte znalosti toho, jak funguje migrace.</span><span class="sxs-lookup"><span data-stu-id="f99f8-213">The good news is that it’s not too hard to deal with the merge manually – provided you have an understanding of how migrations works.</span></span> <span data-ttu-id="f99f8-214">Pokud jste jste přeskočili v této části...</span><span class="sxs-lookup"><span data-stu-id="f99f8-214">So if you’ve skipped ahead to this section…</span></span> <span data-ttu-id="f99f8-215">je nám líto, ale je potřeba vrátit zpět a číst zbývající části článku nejprve!</span><span class="sxs-lookup"><span data-stu-id="f99f8-215">sorry, you need to go back and read the rest of the article first!</span></span>

<span data-ttu-id="f99f8-216">Existují dvě možnosti, nejjednodušší je generování prázdné migrace, který má správnou aktuální model jako snímek.</span><span class="sxs-lookup"><span data-stu-id="f99f8-216">There are two options, the easiest is to generate a blank migration that has the correct current model as a snapshot.</span></span> <span data-ttu-id="f99f8-217">Druhou možností je aktualizovat snímek v posledních migrace na správný snímek modelu.</span><span class="sxs-lookup"><span data-stu-id="f99f8-217">The second option is to update the snapshot in the last migration to have the correct model snapshot.</span></span> <span data-ttu-id="f99f8-218">Druhou možností je o něco složitější a nelze jej použít v každý scénář, ale je také přehlednější protože nezahrnuje přidávání dalších migrace.</span><span class="sxs-lookup"><span data-stu-id="f99f8-218">The second option is a little harder and can’t be used in every scenario, but it’s also cleaner because it doesn’t involve adding an extra migration.</span></span>

### <a name="option-1-add-a-blank-merge-migration"></a><span data-ttu-id="f99f8-219">Možnost 1: Přidejte migraci prázdné "sloučení.</span><span class="sxs-lookup"><span data-stu-id="f99f8-219">Option 1: Add a blank ‘merge’ migration</span></span>

<span data-ttu-id="f99f8-220">Při použití této možnosti se vygeneruje prázdný migrace výhradně pro účely zajištění nejnovější migrace správný model snímku v něm uložena.</span><span class="sxs-lookup"><span data-stu-id="f99f8-220">In this option we generate a blank migration solely for the purpose of making sure the latest migration has the correct model snapshot stored in it.</span></span>

<span data-ttu-id="f99f8-221">Tuto možnost lze použít bez ohledu na to která vygenerovala poslední migrace.</span><span class="sxs-lookup"><span data-stu-id="f99f8-221">This option can be used regardless of who generated the last migration.</span></span> <span data-ttu-id="f99f8-222">V příkladu jsme jste postupovali podle Developer \#2 se postará o sloučení a k nim došlo k vygenerování posledního migrace.</span><span class="sxs-lookup"><span data-stu-id="f99f8-222">In the example we’ve been following Developer \#2 is taking care of the merge and they happened to generate the last migration.</span></span> <span data-ttu-id="f99f8-223">Ale stejný postup můžete použít, pokud pro vývojáře \#1 generované poslední migrace.</span><span class="sxs-lookup"><span data-stu-id="f99f8-223">But these same steps can be used if Developer \#1 generated the last migration.</span></span> <span data-ttu-id="f99f8-224">Postup platí také v případě více migrace se využívá řada – jste právě byla se díváme na dvě aby bylo možné zachovat jednoduché.</span><span class="sxs-lookup"><span data-stu-id="f99f8-224">The steps also apply if there are multiple migrations involved – we’ve just been looking at two in order to keep it simple.</span></span>

<span data-ttu-id="f99f8-225">Následující postup je možné pro tento přístup, od doby, je dobré si uvědomit, že máte změny, které je třeba synchronizovat ze správy zdrojového kódu.</span><span class="sxs-lookup"><span data-stu-id="f99f8-225">The following process can be used for this approach, starting from the time you realize you have changes that need to be synced from source control.</span></span>

1.  <span data-ttu-id="f99f8-226">Zajistěte, aby že byla zapsána změny čekající na vyřízení modelu v vašeho základu kódu místní migrace.</span><span class="sxs-lookup"><span data-stu-id="f99f8-226">Ensure any pending model changes in your local code base have been written to a migration.</span></span> <span data-ttu-id="f99f8-227">Tento krok zajistí, že pokud jde o generování prázdné migrace dobu Nenechte si ujít všechny oprávněné změny.</span><span class="sxs-lookup"><span data-stu-id="f99f8-227">This step ensures you don’t miss any legitimate changes when it comes time to generate the blank migration.</span></span>
2.  <span data-ttu-id="f99f8-228">Synchronizace se správou zdrojového kódu.</span><span class="sxs-lookup"><span data-stu-id="f99f8-228">Sync with source control.</span></span>
3.  <span data-ttu-id="f99f8-229">Spustit **aktualizace databáze** provádět žádné nové migrace, které ostatní vývojáři se změnami.</span><span class="sxs-lookup"><span data-stu-id="f99f8-229">Run **Update-Database** to apply any new migrations that other developers have checked in.</span></span>
    <span data-ttu-id="f99f8-230">**_Poznámka:_**  *Pokud neobdržíte žádné upozornění z příkazu Update-databáze a nebyly žádné nové migrace od jiných vývojářů a není nutné provádět žádné další sloučení.*</span><span class="sxs-lookup"><span data-stu-id="f99f8-230">**_Note:_** *if you don’t get any warnings from the Update-Database command then there were no new migrations from other developers and there is no need to perform any further merging.*</span></span>
4.  <span data-ttu-id="f99f8-231">Spustit **přidat migrace &lt;vyberte\_\_název&gt; – IgnoreChanges** (například **sloučit přidat migrace – IgnoreChanges**).</span><span class="sxs-lookup"><span data-stu-id="f99f8-231">Run **Add-Migration &lt;pick\_a\_name&gt; –IgnoreChanges** (for example, **Add-Migration Merge –IgnoreChanges**).</span></span> <span data-ttu-id="f99f8-232">To generuje migrace s všechna metadata (včetně snímek aktuální model), ale bude ignorovat jakékoli změny zjistí při porovnání aktuálního modelu na snímek v posledních migrace (to znamená získání prázdnou hodnotu **nahoru** a **Dolů** metoda).</span><span class="sxs-lookup"><span data-stu-id="f99f8-232">This generates a migration with all the metadata (including a snapshot of the current model) but will ignore any changes it detects when comparing the current model to the snapshot in the last migrations (meaning you get a blank **Up** and **Down** method).</span></span>
5.  <span data-ttu-id="f99f8-233">Pokračovat ve vývoji, nebo odešlete do správy zdrojového kódu (po spuštění jednotky samozřejmě testy).</span><span class="sxs-lookup"><span data-stu-id="f99f8-233">Continue developing, or submit to source control (after running your unit tests of course).</span></span>

<span data-ttu-id="f99f8-234">Tady je stav pro vývojáře \#2 je místní kódové základny po použití tohoto přístupu.</span><span class="sxs-lookup"><span data-stu-id="f99f8-234">Here is the state of Developer \#2’s local code base after using this approach.</span></span>

![Sloučit migrace](~/ef6/media/mergemigration.png)

### <a name="option-2-update-the-model-snapshot-in-the-last-migration"></a><span data-ttu-id="f99f8-236">Možnost 2: Aktualizace modelu snímku v posledních migrace</span><span class="sxs-lookup"><span data-stu-id="f99f8-236">Option 2: Update the model snapshot in the last migration</span></span>

<span data-ttu-id="f99f8-237">Tato možnost je velmi podobný možnost 1, ale odebere prázdné migrace – protože jasné, kdo chce, aby se soubory zvláštní kód ve svých řešeních.</span><span class="sxs-lookup"><span data-stu-id="f99f8-237">This option is very similar to option 1 but removes the extra blank migration – because let’s face it, who wants extra code files in their solution.</span></span>

<span data-ttu-id="f99f8-238">**Tento přístup je možné pouze v případě nejnovější migrace existuje pouze v místním kódové základny a dosud nebyla odeslána do správy zdrojových kódů (např. Pokud poslední migrace byla vygenerována koncipovaná sloučení)**.</span><span class="sxs-lookup"><span data-stu-id="f99f8-238">**This approach is only feasible if the latest migration exists only in your local code base and has not yet been submitted to source control (for example, if the last migration was generated by the user doing the merge)**.</span></span> <span data-ttu-id="f99f8-239">Úprava metadat migrace, které ostatní vývojáři mohou už jste použili k jejich vývoj databáze – nebo dokonce horší použitý k produkční databázi – může způsobit neočekávané vedlejší účinky.</span><span class="sxs-lookup"><span data-stu-id="f99f8-239">Editing the metadata of migrations that other developers may have already applied to their development database – or even worse applied to a production database – can result in unexpected side effects.</span></span> <span data-ttu-id="f99f8-240">Během procesu budeme vrátit zpět poslední migrace v místní databázi a použijte ho znovu s aktualizovanými metadaty.</span><span class="sxs-lookup"><span data-stu-id="f99f8-240">During the process we’re going to roll back the last migration in our local database and re-apply it with updated metadata.</span></span>

<span data-ttu-id="f99f8-241">Poslední migrace je potřeba jenom ho v místním kódu základní neexistují žádná omezení číslo nebo pořadí migrace, které se pokračovat.</span><span class="sxs-lookup"><span data-stu-id="f99f8-241">While the last migration needs to just be in the local code base there are no restrictions to the number or order of migrations that proceed it.</span></span> <span data-ttu-id="f99f8-242">Může existovat více migrací z více různých vývojářů a použít stejný postup – jste právě byla se díváme na dvě aby bylo možné zachovat jednoduché.</span><span class="sxs-lookup"><span data-stu-id="f99f8-242">There can be multiple migrations from multiple different developers and the same steps apply– we’ve just been looking at two in order to keep it simple.</span></span>

<span data-ttu-id="f99f8-243">Následující postup je možné pro tento přístup, od doby, je dobré si uvědomit, že máte změny, které je třeba synchronizovat ze správy zdrojového kódu.</span><span class="sxs-lookup"><span data-stu-id="f99f8-243">The following process can be used for this approach, starting from the time you realize you have changes that need to be synced from source control.</span></span>

1.  <span data-ttu-id="f99f8-244">Zajistěte, aby že byla zapsána změny čekající na vyřízení modelu v vašeho základu kódu místní migrace.</span><span class="sxs-lookup"><span data-stu-id="f99f8-244">Ensure any pending model changes in your local code base have been written to a migration.</span></span> <span data-ttu-id="f99f8-245">Tento krok zajistí, že pokud jde o generování prázdné migrace dobu Nenechte si ujít všechny oprávněné změny.</span><span class="sxs-lookup"><span data-stu-id="f99f8-245">This step ensures you don’t miss any legitimate changes when it comes time to generate the blank migration.</span></span>
2.  <span data-ttu-id="f99f8-246">Synchronizace se správou zdrojového kódu.</span><span class="sxs-lookup"><span data-stu-id="f99f8-246">Sync with the source control.</span></span>
3.  <span data-ttu-id="f99f8-247">Spustit **aktualizace databáze** provádět žádné nové migrace, které ostatní vývojáři se změnami.</span><span class="sxs-lookup"><span data-stu-id="f99f8-247">Run **Update-Database** to apply any new migrations that other developers have checked in.</span></span>
    <span data-ttu-id="f99f8-248">**_Poznámka:_**  *Pokud neobdržíte žádné upozornění z příkazu Update-databáze a nebyly žádné nové migrace od jiných vývojářů a není nutné provádět žádné další sloučení.*</span><span class="sxs-lookup"><span data-stu-id="f99f8-248">**_Note:_** *if you don’t get any warnings from the Update-Database command then there were no new migrations from other developers and there is no need to perform any further merging.*</span></span>
4.  <span data-ttu-id="f99f8-249">Spustit **aktualizace databáze – TargetMigration &lt;druhý\_poslední\_migrace&gt;**  (v tomto příkladu jsme jste postupovali podle by to byl **aktualizace databáze – TargetMigration AddRating**).</span><span class="sxs-lookup"><span data-stu-id="f99f8-249">Run **Update-Database –TargetMigration &lt;second\_last\_migration&gt;** (in the example we’ve been following this would be **Update-Database –TargetMigration AddRating**).</span></span> <span data-ttu-id="f99f8-250">Tato role databáze zpět do stavu druhého naposledy migrace – efektivně "bez použití" poslední migrace z databáze.</span><span class="sxs-lookup"><span data-stu-id="f99f8-250">This roles the database back to the state of the second last migration – effectively ‘un-applying’ the last migration from the database.</span></span>
    <span data-ttu-id="f99f8-251">**_Poznámka:_**  *tento krok je nutný k němu můžete bezpečně upravovat metadata migrace, protože metadata svazku uloží taky \_ \_MigrationsHistoryTable databáze. To je důvod, proč byste měli používat jenom tato možnost při poslední migrace pouze ve vaší místní základu kódu. Pokud poslední migrace použít jiné databáze by také muset je vrátit zpět a znovu použít posledních migrací pro aktualizaci metadat.*</span><span class="sxs-lookup"><span data-stu-id="f99f8-251">**_Note:_** *This step is required to make it safe to edit the metadata of the migration since the metadata is also stored in the \_\_MigrationsHistoryTable of the database. This is why you should only use this option if the last migration is only in your local code base. If other databases had the last migration applied you would also have to roll them back and re-apply the last migration to update the metadata.*</span></span> 
5.  <span data-ttu-id="f99f8-252">Spustit **přidat migrace &lt;úplné\_název\_včetně\_časové razítko\_z\_poslední\_migrace** &gt; (v příkladu jste postupovali podle jsme to by měl vypadat **přidat migrace 201311062215252\_AddReaders**).</span><span class="sxs-lookup"><span data-stu-id="f99f8-252">Run **Add-Migration &lt;full\_name\_including\_timestamp\_of\_last\_migration**&gt; (in the example we’ve been following this would be something like **Add-Migration 201311062215252\_AddReaders**).</span></span>
    <span data-ttu-id="f99f8-253">**_Poznámka:_**  *bude muset zahrnovat časové razítko, aby migrace věděla, které chcete upravit existující migrace namísto generování nové.*</span><span class="sxs-lookup"><span data-stu-id="f99f8-253">**_Note:_** *You need to include the timestamp so that migrations knows you want to edit the existing migration rather than scaffolding a new one.*</span></span>
    <span data-ttu-id="f99f8-254">Tím se aktualizují metadata pro poslední migraci tak, aby odpovídaly aktuálním modelu.</span><span class="sxs-lookup"><span data-stu-id="f99f8-254">This will update the metadata for the last migration to match the current model.</span></span> <span data-ttu-id="f99f8-255">Pokud se příkaz dokončí, ale to je přesně to co chcete, zobrazí se následující upozornění.</span><span class="sxs-lookup"><span data-stu-id="f99f8-255">You’ll get the following warning when the command completes, but that’s exactly what you want.</span></span> <span data-ttu-id="f99f8-256">"*Pouze návrháře kódu pro migraci" 201311062215252\_byla znovu vygenerované AddReaders'. Chcete-li znovu generování uživatelského rozhraní celé migrace, použijte parametr - Force. "*</span><span class="sxs-lookup"><span data-stu-id="f99f8-256">“*Only the Designer Code for migration '201311062215252\_AddReaders' was re-scaffolded. To re-scaffold the entire migration, use the -Force parameter.”*</span></span>
6.  <span data-ttu-id="f99f8-257">Spustit **aktualizace databáze** znovu použít nejnovější migrace s aktualizovanými metadaty.</span><span class="sxs-lookup"><span data-stu-id="f99f8-257">Run **Update-Database** to re-apply the latest migration with the updated metadata.</span></span>
7.  <span data-ttu-id="f99f8-258">Pokračovat ve vývoji, nebo odešlete do správy zdrojového kódu (po spuštění jednotky samozřejmě testy).</span><span class="sxs-lookup"><span data-stu-id="f99f8-258">Continue developing, or submit to source control (after running your unit tests of course).</span></span>

<span data-ttu-id="f99f8-259">Tady je stav pro vývojáře \#2 je místní kódové základny po použití tohoto přístupu.</span><span class="sxs-lookup"><span data-stu-id="f99f8-259">Here is the state of Developer \#2’s local code base after using this approach.</span></span>

![Aktualizovaná Metadata](~/ef6/media/updatedmetadata.png)

## <a name="summary"></a><span data-ttu-id="f99f8-261">Souhrn</span><span class="sxs-lookup"><span data-stu-id="f99f8-261">Summary</span></span>

<span data-ttu-id="f99f8-262">Zde jsou některé běžné problémy při použití migrace Code First v prostředí team.</span><span class="sxs-lookup"><span data-stu-id="f99f8-262">There are some challenges when using Code First Migrations in a team environment.</span></span> <span data-ttu-id="f99f8-263">Ale základní znalosti o fungování migrace a některé jednoduché přístupy k řešení konfliktů při sloučení usnadňují vyřešit tyto problémy.</span><span class="sxs-lookup"><span data-stu-id="f99f8-263">However, a basic understanding of how migrations works and some simple approaches for resolving merge conflicts make it easy to overcome these challenges.</span></span>

<span data-ttu-id="f99f8-264">Základní problém je nesprávná metadata uložená v nejnovější migrace.</span><span class="sxs-lookup"><span data-stu-id="f99f8-264">The fundamental issue is incorrect metadata stored in the latest migration.</span></span> <span data-ttu-id="f99f8-265">To způsobí, že Code First nesprávně zjistit, že se neshodují současného modelu a schématu databáze a generovat uživatelské rozhraní pro další migrace nesprávný kód.</span><span class="sxs-lookup"><span data-stu-id="f99f8-265">This causes Code First to incorrectly detect that the current model and database schema don’t match and to scaffold incorrect code in the next migration.</span></span> <span data-ttu-id="f99f8-266">Tato situace je možné překonat generování prázdné migrace s modelem správný nebo aktualizace metadat nejnovější migrace.</span><span class="sxs-lookup"><span data-stu-id="f99f8-266">This situation can be overcome by generating a blank migration with the correct model, or updating the metadata in the latest migration.</span></span>
